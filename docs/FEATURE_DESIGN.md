# Skillbox Studio æ–°åŠŸèƒ½è®¾è®¡æ–‡æ¡£

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**åˆ›å»ºæ—¥æœŸ**: 2026-01-26  
**æœ€åæ›´æ–°**: 2026-01-26  
**çŠ¶æ€**: è®¾è®¡é˜¶æ®µ

---

## ğŸ“‘ ç›®å½•

1. [èƒŒæ™¯ä¸ç›®æ ‡](#èƒŒæ™¯ä¸ç›®æ ‡)
2. [åŠŸèƒ½ä¸€ï¼šGit Marketplace ä»“åº“å¯¼å…¥ç³»ç»Ÿ](#åŠŸèƒ½ä¸€git-marketplace-ä»“åº“å¯¼å…¥ç³»ç»Ÿ)
3. [åŠŸèƒ½äºŒï¼šè®¾ç½®åŠŸèƒ½æ¨¡å—](#åŠŸèƒ½äºŒè®¾ç½®åŠŸèƒ½æ¨¡å—)
4. [ç³»ç»Ÿæ¶æ„è®¾è®¡](#ç³»ç»Ÿæ¶æ„è®¾è®¡)
5. [æŠ€æœ¯å®ç°ç»†èŠ‚](#æŠ€æœ¯å®ç°ç»†èŠ‚)
6. [æ•°æ®æ¨¡å‹è®¾è®¡](#æ•°æ®æ¨¡å‹è®¾è®¡)
7. [UI/UX è®¾è®¡æ–¹æ¡ˆ](#uiux-è®¾è®¡æ–¹æ¡ˆ)
8. [å®‰å…¨æ€§è€ƒè™‘](#å®‰å…¨æ€§è€ƒè™‘)
9. [æµ‹è¯•ç­–ç•¥](#æµ‹è¯•ç­–ç•¥)
10. [å®æ–½è®¡åˆ’](#å®æ–½è®¡åˆ’)

---

## èƒŒæ™¯ä¸ç›®æ ‡

### å­˜åœ¨çš„é—®é¢˜

1. **Marketplace æ•°æ®æºå›ºå®š**
   - å½“å‰é€šè¿‡ç¡¬ç¼–ç è·¯å¾„è¯»å– `Skill-Box/.claude-plugin/marketplace.json`
   - ç”¨æˆ·æ— æ³•è‡ªå®šä¹‰æˆ–å¯¼å…¥å…¶ä»–çš„ skill marketplace
   - ç¼ºä¹å¯¹å¤šä¸ª marketplace ä»“åº“çš„ç®¡ç†èƒ½åŠ›

2. **è®¾ç½®åŠŸèƒ½æœªå®ç°**
   - Topbar ä¸­çš„è®¾ç½®æŒ‰é’®ï¼ˆSettingsï¼‰ç›®å‰æ— åŠŸèƒ½
   - ç¼ºå°‘åº”ç”¨é…ç½®ç®¡ç†ç•Œé¢
   - æ²¡æœ‰ç”¨æˆ·åå¥½è®¾ç½®å­˜å‚¨

### è®¾è®¡ç›®æ ‡

æœ¬è®¾è®¡æ–‡æ¡£æ—¨åœ¨è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

1. **Git Marketplace ä»“åº“ç®¡ç†**
   - å…è®¸ç”¨æˆ·æ·»åŠ ã€ç®¡ç†å¤šä¸ª marketplace ä»“åº“
   - æ”¯æŒä» Git ä»“åº“å…‹éš†/æ›´æ–° marketplace
   - æä¾›ä»“åº“ä¼˜å…ˆçº§å’Œå¯ç”¨/ç¦ç”¨æœºåˆ¶

2. **å®Œæ•´çš„è®¾ç½®åŠŸèƒ½æ¨¡å—**
   - Marketplace ä»“åº“ç®¡ç†ç•Œé¢
   - åº”ç”¨é€šç”¨è®¾ç½®ï¼ˆä¸»é¢˜ã€è¯­è¨€ç­‰ï¼‰
   - Agent è·¯å¾„é…ç½®
   - æ•°æ®ç®¡ç†ï¼ˆç¼“å­˜ã€å†å²è®°å½•æ¸…ç†ï¼‰

---

## åŠŸèƒ½ä¸€ï¼šGit Marketplace ä»“åº“å¯¼å…¥ç³»ç»Ÿ

### 1.1 åŠŸèƒ½æ¦‚è¿°

æ”¯æŒç”¨æˆ·é€šè¿‡ Git URL å¯¼å…¥è‡ªå®šä¹‰çš„ skill marketplace ä»“åº“ï¼Œå®ç°å¤šæº marketplace ç®¡ç†ã€‚

### 1.2 æ ¸å¿ƒéœ€æ±‚

#### 1.2.1 ä»“åº“ç®¡ç†

**æ·»åŠ ä»“åº“**
- æ”¯æŒé€šè¿‡ Git URLï¼ˆHTTPS/SSHï¼‰æ·»åŠ è¿œç¨‹ä»“åº“
- è‡ªåŠ¨å…‹éš†ä»“åº“åˆ°æœ¬åœ°å­˜å‚¨ç›®å½•
- éªŒè¯ä»“åº“ç»“æ„ï¼ˆå¿…é¡»åŒ…å« `.claude-plugin/marketplace.json`ï¼‰
- æ”¯æŒè®¾ç½®ä»“åº“åˆ«åï¼ˆç”¨æˆ·å‹å¥½åç§°ï¼‰

**ä»“åº“åˆ—è¡¨**
- æ˜¾ç¤ºæ‰€æœ‰å·²æ·»åŠ çš„ marketplace ä»“åº“
- æ˜¾ç¤ºä»“åº“çŠ¶æ€ï¼šå·²å¯ç”¨/å·²ç¦ç”¨ã€æœ€åæ›´æ–°æ—¶é—´
- åŒºåˆ†"å®˜æ–¹ä»“åº“"å’Œ"è‡ªå®šä¹‰ä»“åº“"

**ä»“åº“æ“ä½œ**
- æ›´æ–°ä»“åº“ï¼ˆgit pullï¼‰
- åˆ é™¤ä»“åº“
- å¯ç”¨/ç¦ç”¨ä»“åº“
- è®¾ç½®ä»“åº“ä¼˜å…ˆçº§ï¼ˆå½±å“æ’ä»¶å±•ç¤ºé¡ºåºï¼‰
- æŸ¥çœ‹ä»“åº“è¯¦ç»†ä¿¡æ¯

#### 1.2.2 æ’ä»¶èšåˆ

**å¤šæºæ•°æ®èšåˆ**
- ä»æ‰€æœ‰å·²å¯ç”¨çš„ä»“åº“è¯»å– marketplace.json
- åˆå¹¶æ‰€æœ‰æ’ä»¶æ•°æ®
- å¤„ç†æ’ä»¶åç§°å†²çªï¼ˆä¼˜å…ˆçº§æœºåˆ¶ï¼‰
- æ ‡è®°æ’ä»¶æ¥æºä»“åº“

**æ™ºèƒ½å»é‡**
- å½“å¤šä¸ªä»“åº“åŒ…å«åŒåæ’ä»¶æ—¶ï¼Œæ ¹æ®ä¼˜å…ˆçº§é€‰æ‹©
- æ˜¾ç¤ºæ’ä»¶æ¥æºä¿¡æ¯

### 1.3 æŠ€æœ¯è¦ç‚¹

#### 1.3.1 æœ¬åœ°å­˜å‚¨ç»“æ„

```
~/.skillbox-studio/
â”œâ”€â”€ config.json                    # åº”ç”¨é…ç½®
â”œâ”€â”€ repositories/                  # Git ä»“åº“å­˜å‚¨
â”‚   â”œâ”€â”€ official-skillbox/         # å®˜æ–¹ä»“åº“ï¼ˆé»˜è®¤ï¼‰
â”‚   â”‚   â”œâ”€â”€ .git/
â”‚   â”‚   â””â”€â”€ .claude-plugin/
â”‚   â”‚       â””â”€â”€ marketplace.json
â”‚   â”œâ”€â”€ custom-repo-1/             # è‡ªå®šä¹‰ä»“åº“1
â”‚   â”‚   â”œâ”€â”€ .git/
â”‚   â”‚   â””â”€â”€ .claude-plugin/
â”‚   â”‚       â””â”€â”€ marketplace.json
â”‚   â””â”€â”€ custom-repo-2/             # è‡ªå®šä¹‰ä»“åº“2
â””â”€â”€ cache/                         # ç¼“å­˜æ•°æ®
    â””â”€â”€ merged-marketplace.json    # èšåˆåçš„marketplaceæ•°æ®
```

#### 1.3.2 Git æ“ä½œå®ç°

ä½¿ç”¨ `git2-rs` crateï¼ˆRustï¼‰æˆ– Tauri å‘½ä»¤æ‰§è¡Œç³»ç»Ÿ gitï¼š

**æ–¹æ¡ˆ Aï¼šä½¿ç”¨ git2-rs**
- **ä¼˜ç‚¹**ï¼šçº¯ Rust å®ç°ï¼Œæ— éœ€ç³»ç»Ÿ git
- **ç¼ºç‚¹**ï¼šéœ€è¦æ·»åŠ ä¾èµ–ï¼Œæ‰“åŒ…ä½“ç§¯å¢åŠ 

**æ–¹æ¡ˆ Bï¼šè°ƒç”¨ç³»ç»Ÿ git**
- **ä¼˜ç‚¹**ï¼šè½»é‡ï¼Œåˆ©ç”¨ç”¨æˆ·ç°æœ‰ git é…ç½®
- **ç¼ºç‚¹**ï¼šéœ€è¦ç”¨æˆ·å®‰è£… git

**æ¨è**ï¼šæ–¹æ¡ˆ Bï¼ˆç³»ç»Ÿ gitï¼‰ï¼Œé€šè¿‡ Tauri Command æ‰§è¡Œ

```rust
// å…‹éš†ä»“åº“
async fn clone_repository(url: String, dest: PathBuf) -> Result<(), String>

// æ›´æ–°ä»“åº“
async fn update_repository(path: PathBuf) -> Result<(), String>

// éªŒè¯ä»“åº“
fn validate_marketplace_repo(path: PathBuf) -> Result<bool, String>
```

---

## åŠŸèƒ½äºŒï¼šè®¾ç½®åŠŸèƒ½æ¨¡å—

### 2.1 åŠŸèƒ½æ¦‚è¿°

å®Œæ•´çš„åº”ç”¨è®¾ç½®ç•Œé¢ï¼Œæä¾›ç”¨æˆ·é…ç½®ç®¡ç†ã€ä»“åº“ç®¡ç†ã€æ•°æ®ç®¡ç†ç­‰åŠŸèƒ½ã€‚

### 2.2 è®¾ç½®é¡µé¢ç»“æ„

#### 2.2.1 é€‰é¡¹å¡å¼å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Settings                         [X]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [General]  [Marketplace]  [Agents]      â”‚
â”‚ [Advanced] [About]                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  (é€‰ä¸­é€‰é¡¹å¡çš„å†…å®¹åŒºåŸŸ)                   â”‚
â”‚                                         â”‚
â”‚                                         â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.2.2 Generalï¼ˆé€šç”¨è®¾ç½®ï¼‰

**ä¸»é¢˜è®¾ç½®**
- Light Mode / Dark Mode / Autoï¼ˆè·Ÿéšç³»ç»Ÿï¼‰
- ä¸»é¢˜é¢œè‰²é€‰æ‹©å™¨

**è¯­è¨€è®¾ç½®**
- English / ç®€ä½“ä¸­æ–‡
- è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿè¯­è¨€

**å…¶ä»–**

- å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥æ›´æ–°
- å®‰è£…ç¡®è®¤å¯¹è¯æ¡†ï¼ˆå¼€/å…³ï¼‰

#### 2.2.3 Marketplaceï¼ˆä»“åº“ç®¡ç†ï¼‰

**ä»“åº“åˆ—è¡¨**
- è¡¨æ ¼æ˜¾ç¤ºæ‰€æœ‰ä»“åº“
  - åç§°ï¼ˆåˆ«åï¼‰
  - Git URL
  - çŠ¶æ€ï¼ˆå¯ç”¨/ç¦ç”¨ï¼‰
  - æ’ä»¶æ•°é‡
  - æœ€åæ›´æ–°æ—¶é—´
  - æ“ä½œæŒ‰é’®ï¼ˆæ›´æ–°/ç¦ç”¨/åˆ é™¤/æŸ¥çœ‹è¯¦æƒ…ï¼‰

**æ·»åŠ ä»“åº“æŒ‰é’®**
- æ‰“å¼€å¯¹è¯æ¡†
  - è¾“å…¥æ¡†ï¼šGit URL
  - è¾“å…¥æ¡†ï¼šä»“åº“åˆ«åï¼ˆå¯é€‰ï¼‰
  - é€‰æ‹©æ¡†ï¼šè®¤è¯æ–¹å¼ï¼ˆPublic / SSH Key / HTTPS Tokenï¼‰
  - æŒ‰é’®ï¼šéªŒè¯ & æ·»åŠ 

**ä»“åº“ä¼˜å…ˆçº§ç®¡ç†**
- æ‹–æ‹½æ’åºåŠŸèƒ½
- ä¼˜å…ˆçº§æ•°å­—æ˜¾ç¤º


#### 2.2.4 Advancedï¼ˆé«˜çº§è®¾ç½®ï¼‰

**æ•°æ®ç®¡ç†**
- æ¸…é™¤ç¼“å­˜æŒ‰é’®

- æ¸…é™¤å®‰è£…å†å²è®°å½•ï¼ˆå¸¦æ—¥æœŸé€‰æ‹©ï¼‰

  

#### 2.2.6 Aboutï¼ˆå…³äºï¼‰

- åº”ç”¨ç‰ˆæœ¬ä¿¡æ¯
- å¼€æºè®¸å¯è¯
- GitHub é“¾æ¥
- æ£€æŸ¥æ›´æ–°æŒ‰é’®

### 2.3 è®¾ç½®æ•°æ®å­˜å‚¨

#### 2.3.1 é…ç½®æ–‡ä»¶ç»“æ„

`~/.skillbox-studio/config.json`:

```json
{
  "version": "1.0",
  "general": {
    "theme": "auto",         // "light" | "dark" | "auto"
    "language": "zh-CN",     // "en" | "zh-CN"
    "startup_page": "install",
    "card_density": "comfortable",
    "auto_check_updates": true,
    "confirm_before_install": true
  },
  "marketplace": {
    "repositories": [
      {
        "id": "official",
        "name": "Official Skillbox",
        "url": "https://github.com/username/Skill-Box",
        "type": "official",
        "enabled": true,
        "priority": 1,
        "local_path": "~/.skillbox-studio/repositories/official-skillbox",
        "last_updated": "2026-01-26T00:00:00Z",
        "auth_type": "public"
      },
      {
        "id": "custom-1",
        "name": "My Custom Skills",
        "url": "https://github.com/user/custom-skills",
        "type": "custom",
        "enabled": true,
        "priority": 2,
        "local_path": "~/.skillbox-studio/repositories/custom-repo-1",
        "last_updated": "2026-01-25T12:30:00Z",
        "auth_type": "public"
      }
    ]
  },
  "agents": {
    "custom_paths": {
      "claude": "/custom/path/to/claude",
      "cursor": "/custom/path/to/cursor"
    },
    "custom_icons": {}
  },
  "advanced": {
    "debug_mode": false,
    "cache_enabled": true,
    "max_history_records": 500
  }
}
```

---

## ç³»ç»Ÿæ¶æ„è®¾è®¡

### 3.1 æ•´ä½“æ¶æ„

```mermaid
graph TB
    subgraph Frontend["å‰ç«¯å±‚ (React + TypeScript)"]
        UI[UI Components]
        Store[State Management]
        API[API Client]
    end

    subgraph Backend["åç«¯å±‚ (Rust + Tauri)"]
        Commands[Tauri Commands]
        GitMgr[Git Manager]
        MarketMgr[Marketplace Manager]
        ConfigMgr[Config Manager]
    end

    subgraph Storage["å­˜å‚¨å±‚"]
        GitRepos[(Git Repositories)]
        ConfigFile[(config.json)]
        Cache[(Cache)]
    end

    UI --> Store
    Store --> API
    API --> Commands
    Commands --> GitMgr
    Commands --> MarketMgr
    Commands --> ConfigMgr
    GitMgr --> GitRepos
    MarketMgr --> GitRepos
    MarketMgr --> Cache
    ConfigMgr --> ConfigFile
```

### 3.2 æ¨¡å—èŒè´£

#### 3.2.1 å‰ç«¯æ¨¡å—

**SettingsPage.tsx**
- è®¾ç½®é¡µé¢ä¸»å®¹å™¨
- é€‰é¡¹å¡åˆ‡æ¢é€»è¾‘

**MarketplaceSettings.tsx**
- Marketplace ä»“åº“ç®¡ç†ç•Œé¢
- ä»“åº“åˆ—è¡¨ã€æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤

**GeneralSettings.tsx**
- é€šç”¨è®¾ç½®ç•Œé¢
- ä¸»é¢˜ã€è¯­è¨€ã€ç•Œé¢é€‰é¡¹

**AgentSettings.tsx**
- Agent é…ç½®ç•Œé¢

**AdvancedSettings.tsx**
- é«˜çº§è®¾ç½®ç•Œé¢

#### 3.2.2 åç«¯æ¨¡å—

**commands/git_manager.rs**
- Git ä»“åº“æ“ä½œå°è£…
- å…‹éš†ã€æ›´æ–°ã€åˆ é™¤ä»“åº“

**commands/marketplace_manager.rs**
- Marketplace æ•°æ®èšåˆ
- å¤šä»“åº“æ•°æ®åˆå¹¶
- æ’ä»¶å†²çªå¤„ç†

**commands/config_manager.rs**
- é…ç½®æ–‡ä»¶è¯»å†™
- é…ç½®éªŒè¯å’Œè¿ç§»

---

## æŠ€æœ¯å®ç°ç»†èŠ‚

### 4.1 åç«¯ Command æ¥å£è®¾è®¡

#### 4.1.1 Git ä»“åº“ç®¡ç†å‘½ä»¤

```rust
// src-tauri/src/commands/git_manager.rs

#[tauri::command]
pub async fn add_marketplace_repository(
    url: String,
    name: String,
    auth_type: String,
    auth_token: Option<String>
) -> Result<RepositoryInfo, String> {
    // 1. éªŒè¯ URL åˆæ³•æ€§
    // 2. ç”Ÿæˆå”¯ä¸€ ID
    // 3. ç¡®å®šæœ¬åœ°å­˜å‚¨è·¯å¾„
    // 4. æ‰§è¡Œ git clone
    // 5. éªŒè¯ä»“åº“ç»“æ„ï¼ˆæ£€æŸ¥ .claude-plugin/marketplace.jsonï¼‰
    // 6. æ›´æ–° config.json
    // 7. è¿”å›ä»“åº“ä¿¡æ¯
}

#[tauri::command]
pub async fn update_repository(
    repo_id: String
) -> Result<UpdateResult, String> {
    // 1. ä» config.json è¯»å–ä»“åº“ä¿¡æ¯
    // 2. æ‰§è¡Œ git pull
    // 3. æ›´æ–°æœ€åæ›´æ–°æ—¶é—´
    // 4. æ¸…é™¤ç¼“å­˜
    // 5. è¿”å›æ›´æ–°ç»“æœ
}

#[tauri::command]
pub fn remove_repository(
    repo_id: String
) -> Result<(), String> {
    // 1. ä» config.json åˆ é™¤ä»“åº“é…ç½®
    // 2. åˆ é™¤æœ¬åœ°ä»“åº“ç›®å½•
    // 3. æ¸…é™¤ç›¸å…³ç¼“å­˜
}

#[tauri::command]
pub fn toggle_repository(
    repo_id: String,
    enabled: bool
) -> Result<(), String> {
    // 1. æ›´æ–° config.json ä¸­çš„ enabled å­—æ®µ
    // 2. æ¸…é™¤ç¼“å­˜ï¼ˆè§¦å‘é‡æ–°èšåˆï¼‰
}

#[tauri::command]
pub fn set_repository_priority(
    repo_id: String,
    priority: u32
) -> Result<(), String> {
    // æ›´æ–°ä»“åº“ä¼˜å…ˆçº§
}

#[tauri::command]
pub fn get_all_repositories() -> Result<Vec<RepositoryInfo>, String> {
    // è¿”å›æ‰€æœ‰ä»“åº“ä¿¡æ¯
}
```

#### 4.1.2 Marketplace æ•°æ®èšåˆå‘½ä»¤

```rust
// src-tauri/src/commands/marketplace_manager.rs

#[tauri::command]
pub fn get_aggregated_marketplace_data() -> Result<MarketplaceData, String> {
    // 1. è¯»å– config.json è·å–å·²å¯ç”¨çš„ä»“åº“åˆ—è¡¨
    // 2. æ£€æŸ¥ç¼“å­˜æ˜¯å¦æœ‰æ•ˆ
    // 3. å¦‚æœç¼“å­˜æ— æ•ˆï¼Œä»æ‰€æœ‰ä»“åº“è¯»å– marketplace.json
    // 4. æ ¹æ®ä¼˜å…ˆçº§åˆå¹¶æ•°æ®
    // 5. å¤„ç†æ’ä»¶å†²çªï¼ˆåŒåæ’ä»¶é€‰æ‹©é«˜ä¼˜å…ˆçº§ä»“åº“çš„ï¼‰
    // 6. æ›´æ–°ç¼“å­˜
    // 7. è¿”å›èšåˆæ•°æ®
}

#[tauri::command]
pub fn validate_marketplace_repository(
    path: String
) -> Result<ValidationResult, String> {
    // éªŒè¯ç›®å½•æ˜¯å¦ä¸ºæœ‰æ•ˆçš„ marketplace ä»“åº“
    // æ£€æŸ¥ .claude-plugin/marketplace.json æ˜¯å¦å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®
}
```

#### 4.1.3 é…ç½®ç®¡ç†å‘½ä»¤

```rust
// src-tauri/src/commands/config_manager.rs

#[tauri::command]
pub fn get_app_config() -> Result<AppConfig, String> {
    // è¯»å–å¹¶è¿”å›å®Œæ•´åº”ç”¨é…ç½®
}

#[tauri::command]
pub fn update_general_settings(
    settings: GeneralSettings
) -> Result<(), String> {
    // æ›´æ–°é€šç”¨è®¾ç½®
}

#[tauri::command]
pub fn update_agent_paths(
    agent_id: String,
    custom_path: String
) -> Result<(), String> {
    // æ›´æ–° Agent è‡ªå®šä¹‰è·¯å¾„
}

#[tauri::command]
pub fn reset_all_settings() -> Result<(), String> {
    // é‡ç½®ä¸ºé»˜è®¤é…ç½®
}

#[tauri::command]
pub fn export_config() -> Result<String, String> {
    // å¯¼å‡ºé…ç½®ä¸º JSON å­—ç¬¦ä¸²
}

#[tauri::command]
pub fn import_config(config_json: String) -> Result<(), String> {
    // å¯¼å…¥é…ç½®
}

#[tauri::command]
pub fn clear_cache() -> Result<(), String> {
    // æ¸…é™¤æ‰€æœ‰ç¼“å­˜
}
```

### 4.2 å‰ç«¯ API å°è£…

```typescript
// src/lib/api.ts (æ‰©å±•)

// Git ä»“åº“ç®¡ç†
export interface RepositoryInfo {
    id: string;
    name: string;
    url: string;
    type: "official" | "custom";
    enabled: boolean;
    priority: number;
    local_path: string;
    last_updated: string;
    plugin_count?: number;
}

export async function addMarketplaceRepository(
    url: string,
    name: string,
    authType: string,
    authToken?: string
): Promise<RepositoryInfo> {
    return invoke("add_marketplace_repository", { url, name, auth_type: authType, auth_token: authToken });
}

export async function updateRepository(repoId: string): Promise<UpdateResult> {
    return invoke("update_repository", { repo_id: repoId });
}

export async function removeRepository(repoId: string): Promise<void> {
    return invoke("remove_repository", { repo_id: repoId });
}

export async function toggleRepository(repoId: string, enabled: boolean): Promise<void> {
    return invoke("toggle_repository", { repo_id: repoId, enabled });
}

export async function getAllRepositories(): Promise<RepositoryInfo[]> {
    return invoke("get_all_repositories");
}

// é…ç½®ç®¡ç†
export interface AppConfig {
    general: GeneralSettings;
    marketplace: MarketplaceConfig;
    agents: AgentsConfig;
    advanced: AdvancedSettings;
}

export async function getAppConfig(): Promise<AppConfig> {
    return invoke("get_app_config");
}

export async function updateGeneralSettings(settings: GeneralSettings): Promise<void> {
    return invoke("update_general_settings", { settings });
}

export async function clearCache(): Promise<void> {
    return invoke("clear_cache");
}
```

### 4.3 Git æ“ä½œå®ç°ç¤ºä¾‹

```rust
// src-tauri/src/commands/git_manager.rs

use std::process::Command;
use std::path::{Path, PathBuf};

pub async fn clone_repository(url: &str, dest: &Path) -> Result<(), String> {
    let output = Command::new("git")
        .args(&["clone", url, dest.to_str().unwrap()])
        .output()
        .map_err(|e| format!("Failed to execute git clone: {}", e))?;

    if !output.status.success() {
        let stderr = String::from_utf8_lossy(&output.stderr);
        return Err(format!("Git clone failed: {}", stderr));
    }

    Ok(())
}

pub async fn pull_repository(path: &Path) -> Result<(), String> {
    let output = Command::new("git")
        .args(&["-C", path.to_str().unwrap(), "pull"])
        .output()
        .map_err(|e| format!("Failed to execute git pull: {}", e))?;

    if !output.status.success() {
        let stderr = String::from_utf8_lossy(&output.stderr);
        return Err(format!("Git pull failed: {}", stderr));
    }

    Ok(())
}

pub fn validate_marketplace_repo(path: &Path) -> Result<bool, String> {
    let marketplace_json = path.join(".claude-plugin/marketplace.json");
    
    if !marketplace_json.exists() {
        return Err("Repository does not contain .claude-plugin/marketplace.json".to_string());
    }

    // å°è¯•è§£æ JSON
    let content = std::fs::read_to_string(&marketplace_json)
        .map_err(|e| format!("Failed to read marketplace.json: {}", e))?;
    
    serde_json::from_str::<MarketplaceData>(&content)
        .map_err(|e| format!("Invalid marketplace.json format: {}", e))?;

    Ok(true)
}
```

---

## æ•°æ®æ¨¡å‹è®¾è®¡

### 5.1 Rust ç±»å‹å®šä¹‰

```rust
// src-tauri/src/types.rs (æ‰©å±•)

use serde::{Deserialize, Serialize};

#[derive(Debug, Serialize, Deserialize, Clone)]
pub struct AppConfig {
    pub version: String,
    pub general: GeneralSettings,
    pub marketplace: MarketplaceConfig,
    pub agents: AgentsConfig,
    pub advanced: AdvancedSettings,
}

#[derive(Debug, Serialize, Deserialize, Clone)]
pub struct GeneralSettings {
    pub theme: String,
    pub language: String,
    pub startup_page: String,
    pub card_density: String,
    pub auto_check_updates: bool,
    pub confirm_before_install: bool,
}

#[derive(Debug, Serialize, Deserialize, Clone)]
pub struct MarketplaceConfig {
    pub repositories: Vec<RepositoryInfo>,
}

#[derive(Debug, Serialize, Deserialize, Clone)]
pub struct RepositoryInfo {
    pub id: String,
    pub name: String,
    pub url: String,
    #[serde(rename = "type")]
    pub repo_type: String, // "official" | "custom"
    pub enabled: bool,
    pub priority: u32,
    pub local_path: String,
    pub last_updated: String,
    pub auth_type: String, // "public" | "ssh" | "token"
}

#[derive(Debug, Serialize, Deserialize, Clone)]
pub struct AgentsConfig {
    pub custom_paths: std::collections::HashMap<String, String>,
    pub custom_icons: std::collections::HashMap<String, String>,
}

#[derive(Debug, Serialize, Deserialize, Clone)]
pub struct AdvancedSettings {
    pub debug_mode: bool,
    pub cache_enabled: bool,
    pub max_history_records: u32,
}

#[derive(Debug, Serialize, Deserialize)]
pub struct UpdateResult {
    pub success: bool,
    pub changes: String,
    pub commits: Vec<String>,
}

#[derive(Debug, Serialize, Deserialize)]
pub struct ValidationResult {
    pub valid: bool,
    pub errors: Vec<String>,
    pub plugin_count: u32,
}
```

### 5.2 TypeScript ç±»å‹å®šä¹‰ 

```typescript
// src/lib/types.ts (æ–°å»º)

export interface AppConfig {
    version: string;
    general: GeneralSettings;
    marketplace: MarketplaceConfig;
    agents: AgentsConfig;
    advanced: AdvancedSettings;
}

export interface GeneralSettings {
    theme: "light" | "dark" | "auto";
    language: "en" | "zh-CN";
    startup_page: "install" | "installed";
    card_density: "compact" | "comfortable" | "spacious";
    auto_check_updates: boolean;
    confirm_before_install: boolean;
}

export interface MarketplaceConfig {
    repositories: RepositoryInfo[];
}

export interface RepositoryInfo {
    id: string;
    name: string;
    url: string;
    type: "official" | "custom";
    enabled: boolean;
    priority: number;
    local_path: string;
    last_updated: string;
    auth_type: "public" | "ssh" | "token";
    plugin_count?: number;
}

export interface AgentsConfig {
    custom_paths: Record<string, string>;
    custom_icons: Record<string, string>;
}

export interface AdvancedSettings {
    debug_mode: boolean;
    cache_enabled: boolean;
    max_history_records: number;
}
```

---

## UI/UX è®¾è®¡æ–¹æ¡ˆ

### 6.1 è®¾ç½®é¡µé¢å¸ƒå±€

**æ¨¡æ€å¯¹è¯æ¡† vs ç‹¬ç«‹é¡µé¢**

**æ¨èæ–¹æ¡ˆï¼šæ¨¡æ€å¯¹è¯æ¡†**
- æ›´ç¬¦åˆè®¾ç½®ç±»åŠŸèƒ½çš„äº¤äº’ä¹ æƒ¯
- ä¸å¹²æ‰°ä¸»å·¥ä½œæµï¼ˆInstall / Installed é¡µé¢ï¼‰
- å¯ä»¥å¿«é€Ÿæ‰“å¼€å’Œå…³é—­

**å®ç°æ–¹å¼ï¼šä½¿ç”¨ Dialog ç»„ä»¶**

```tsx
// src/components/SettingsDialog.tsx

export function SettingsDialog({ open, onClose }: SettingsDialogProps) {
    const [activeTab, setActiveTab] = useState("general");

    return (
        <Dialog open={open} onOpenChange={onClose}>
            <DialogContent className="max-w-4xl h-[600px]">
                <DialogHeader>
                    <DialogTitle>è®¾ç½®</DialogTitle>
                </DialogHeader>

                <div className="flex h-full gap-4">
                    {/* å·¦ä¾§é€‰é¡¹å¡å¯¼èˆª */}
                    <nav className="w-48 border-r pr-4 space-y-1">
                        <TabButton 
                            active={activeTab === "general"} 
                            onClick={() => setActiveTab("general")}
                            icon={<Settings />}
                        >
                            é€šç”¨
                        </TabButton>
                        <TabButton 
                            active={activeTab === "marketplace"} 
                            onClick={() => setActiveTab("marketplace")}
                            icon={<GitBranch />}
                        >
                            Marketplace
                        </TabButton>
                        {/* ... å…¶ä»–é€‰é¡¹å¡ ... */}
                    </nav>

                    {/* å³ä¾§å†…å®¹åŒºåŸŸ */}
                    <div className="flex-1 overflow-y-auto">
                        {activeTab === "general" && <GeneralSettings />}
                        {activeTab === "marketplace" && <MarketplaceSettings />}
                        {/* ... å…¶ä»–å†…å®¹ ... */}
                    </div>
                </div>
            </DialogContent>
        </Dialog>
    );
}
```

### 6.2 Marketplace ä»“åº“ç®¡ç†ç•Œé¢

#### 6.2.1 ä»“åº“åˆ—è¡¨

```tsx
// src/components/settings/MarketplaceSettings.tsx

export function MarketplaceSettings() {
    const [repositories, setRepositories] = useState<RepositoryInfo[]>([]);
    const [addDialogOpen, setAddDialogOpen] = useState(false);

    return (
        <div className="space-y-6">
            <div className="flex justify-between items-center">
                <h3 className="text-lg font-semibold">Marketplace ä»“åº“</h3>
                <Button onClick={() => setAddDialogOpen(true)}>
                    <Plus className="h-4 w-4 mr-2" />
                    æ·»åŠ ä»“åº“
                </Button>
            </div>

            <div className="border rounded-lg overflow-hidden">
                <Table>
                    <TableHeader>
                        <TableRow>
                            <TableHead>åç§°</TableHead>
                            <TableHead>URL</TableHead>
                            <TableHead>æ’ä»¶æ•°</TableHead>
                            <TableHead>çŠ¶æ€</TableHead>
                            <TableHead>æœ€åæ›´æ–°</TableHead>
                            <TableHead>æ“ä½œ</TableHead>
                        </TableRow>
                    </TableHeader>
                    <TableBody>
                        {repositories.map(repo => (
                            <TableRow key={repo.id}>
                                <TableCell className="font-medium">
                                    {repo.type === "official" && (
                                        <Badge variant="secondary" className="mr-2">å®˜æ–¹</Badge>
                                    )}
                                    {repo.name}
                                </TableCell>
                                <TableCell className="font-mono text-xs">
                                    {repo.url}
                                </TableCell>
                                <TableCell>{repo.plugin_count || 0}</TableCell>
                                <TableCell>
                                    <Switch 
                                        checked={repo.enabled}
                                        onCheckedChange={(enabled) => handleToggle(repo.id, enabled)}
                                    />
                                </TableCell>
                                <TableCell className="text-sm text-muted-foreground">
                                    {formatDate(repo.last_updated)}
                                </TableCell>
                                <TableCell>
                                    <DropdownMenu>
                                        <DropdownMenuTrigger asChild>
                                            <Button variant="ghost" size="sm">
                                                <MoreVertical className="h-4 w-4" />
                                            </Button>
                                        </DropdownMenuTrigger>
                                        <DropdownMenuContent>
                                            <DropdownMenuItem onClick={() => handleUpdate(repo.id)}>
                                                <RefreshCw className="h-4 w-4 mr-2" />
                                                æ›´æ–°
                                            </DropdownMenuItem>
                                            <DropdownMenuItem onClick={() => handleViewDetails(repo.id)}>
                                                <Info className="h-4 w-4 mr-2" />
                                                è¯¦æƒ…
                                            </DropdownMenuItem>
                                            <DropdownMenuSeparator />
                                            <DropdownMenuItem 
                                                onClick={() => handleDelete(repo.id)}
                                                className="text-destructive"
                                            >
                                                <Trash2 className="h-4 w-4 mr-2" />
                                                åˆ é™¤
                                            </DropdownMenuItem>
                                        </DropdownMenuContent>
                                    </DropdownMenu>
                                </TableCell>
                            </TableRow>
                        ))}
                    </TableBody>
                </Table>
            </div>

            <AddRepositoryDialog 
                open={addDialogOpen}
                onClose={() => setAddDialogOpen(false)}
                onSuccess={handleAddSuccess}
            />
        </div>
    );
}
```

#### 6.2.2 æ·»åŠ ä»“åº“å¯¹è¯æ¡†

```tsx
// src/components/settings/AddRepositoryDialog.tsx

export function AddRepositoryDialog({ open, onClose, onSuccess }: Props) {
    const [url, setUrl] = useState("");
    const [name, setName] = useState("");
    const [authType, setAuthType] = useState<"public" | "ssh" | "token">("public");
    const [loading, setLoading] = useState(false);

    const handleAdd = async () => {
        setLoading(true);
        try {
            const repo = await addMarketplaceRepository(url, name, authType);
            onSuccess(repo);
            onClose();
        } catch (e: any) {
            alert(`æ·»åŠ å¤±è´¥: ${e.toString()}`);
        } finally {
            setLoading(false);
        }
    };

    return (
        <Dialog open={open} onOpenChange={onClose}>
            <DialogContent>
                <DialogHeader>
                    <DialogTitle>æ·»åŠ  Marketplace ä»“åº“</DialogTitle>
                    <DialogDescription>
                        ä» Git ä»“åº“å¯¼å…¥è‡ªå®šä¹‰ skill marketplace
                    </DialogDescription>
                </DialogHeader>

                <div className="space-y-4">
                    <div>
                        <Label>Git URL</Label>
                        <Input
                            placeholder="https://github.com/username/repo"
                            value={url}
                            onChange={(e) => setUrl(e.target.value)}
                        />
                    </div>

                    <div>
                        <Label>ä»“åº“åç§°ï¼ˆå¯é€‰ï¼‰</Label>
                        <Input
                            placeholder="My Custom Skills"
                            value={name}
                            onChange={(e) => setName(e.target.value)}
                        />
                    </div>

                    <div>
                        <Label>è®¤è¯æ–¹å¼</Label>
                        <Select value={authType} onValueChange={setAuthType}>
                            <SelectTrigger>
                                <SelectValue />
                            </SelectTrigger>
                            <SelectContent>
                                <SelectItem value="public">Publicï¼ˆæ— éœ€è®¤è¯ï¼‰</SelectItem>
                                <SelectItem value="ssh">SSH Key</SelectItem>
                                <SelectItem value="token">HTTPS Token</SelectItem>
                            </SelectContent>
                        </Select>
                    </div>
                </div>

                <DialogFooter>
                    <Button variant="outline" onClick={onClose}>å–æ¶ˆ</Button>
                    <Button onClick={handleAdd} disabled={!url || loading}>
                        {loading ? <Loader2 className="h-4 w-4 animate-spin" /> : "æ·»åŠ "}
                    </Button>
                </DialogFooter>
            </DialogContent>
        </Dialog>
    );
}
```

### 6.3 é€šç”¨è®¾ç½®ç•Œé¢

```tsx
// src/components/settings/GeneralSettings.tsx

export function GeneralSettings() {
    const [settings, setSettings] = useState<GeneralSettings | null>(null);

    useEffect(() => {
        async function load() {
            const config = await getAppConfig();
            setSettings(config.general);
        }
        load();
    }, []);

    const handleSave = async () => {
        if (settings) {
            await updateGeneralSettings(settings);
        }
    };

    if (!settings) return <div>Loading...</div>;

    return (
        <div className="space-y-6">
            <div>
                <h3 className="text-lg font-semibold mb-4">å¤–è§‚</h3>
                <div className="space-y-4">
                    <div>
                        <Label>ä¸»é¢˜</Label>
                        <Select 
                            value={settings.theme} 
                            onValueChange={(v) => setSettings({...settings, theme: v})}
                        >
                            <SelectTrigger className="w-48">
                                <SelectValue />
                            </SelectTrigger>
                            <SelectContent>
                                <SelectItem value="light">æµ…è‰²</SelectItem>
                                <SelectItem value="dark">æ·±è‰²</SelectItem>
                                <SelectItem value="auto">è·Ÿéšç³»ç»Ÿ</SelectItem>
                            </SelectContent>
                        </Select>
                    </div>

                    <div>
                        <Label>è¯­è¨€</Label>
                        <Select 
                            value={settings.language} 
                            onValueChange={(v) => setSettings({...settings, language: v})}
                        >
                            <SelectTrigger className="w-48">
                                <SelectValue />
                            </SelectTrigger>
                            <SelectContent>
                                <SelectItem value="en">English</SelectItem>
                                <SelectItem value="zh-CN">ç®€ä½“ä¸­æ–‡</SelectItem>
                            </SelectContent>
                        </Select>
                    </div>
                </div>
            </div>

            <Separator />

            <div>
                <h3 className="text-lg font-semibold mb-4">è¡Œä¸º</h3>
                <div className="space-y-4">
                    <div className="flex items-center justify-between">
                        <div>
                            <Label>å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥æ›´æ–°</Label>
                            <p className="text-sm text-muted-foreground">
                                åœ¨åº”ç”¨å¯åŠ¨æ—¶æ£€æŸ¥æ–°ç‰ˆæœ¬
                            </p>
                        </div>
                        <Switch
                            checked={settings.auto_check_updates}
                            onCheckedChange={(v) => setSettings({...settings, auto_check_updates: v})}
                        />
                    </div>

                    <div className="flex items-center justify-between">
                        <div>
                            <Label>å®‰è£…å‰ç¡®è®¤</Label>
                            <p className="text-sm text-muted-foreground">
                                å®‰è£…æ’ä»¶å‰æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
                            </p>
                        </div>
                        <Switch
                            checked={settings.confirm_before_install}
                            onCheckedChange={(v) => setSettings({...settings, confirm_before_install: v})}
                        />
                    </div>
                </div>
            </div>

            <div className="flex justify-end">
                <Button onClick={handleSave}>ä¿å­˜è®¾ç½®</Button>
            </div>
        </div>
    );
}
```

---

## å®‰å…¨æ€§è€ƒè™‘

### 7.1 Git ä»“åº“å®‰å…¨

**URL éªŒè¯**
- åªå…è®¸ HTTPS å’Œ SSH åè®®
- æ‹’ç»æœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼ˆ`file://`ï¼‰
- éªŒè¯ URL æ ¼å¼åˆæ³•æ€§

**è·¯å¾„éå†é˜²æŠ¤**
- ç¡®ä¿å…‹éš†çš„ä»“åº“åªå†™å…¥æŒ‡å®šç›®å½•
- ç¦æ­¢ `..` ç­‰è·¯å¾„éå†å­—ç¬¦

**ä»£ç æ‰§è¡Œé£é™©**
- Marketplace JSON åªåŒ…å«æ•°æ®ï¼Œä¸æ‰§è¡Œä»£ç 
- å®‰è£…çš„ skills æ˜¯ç”±ç”¨æˆ·ä¸»åŠ¨é€‰æ‹©çš„

### 7.2 è®¤è¯ä¿¡æ¯å®‰å…¨

**Token å­˜å‚¨**
- ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„å¯†é’¥é“¾ï¼ˆKeyringï¼‰å­˜å‚¨è®¤è¯ token
- ä¸åœ¨é…ç½®æ–‡ä»¶ä¸­æ˜æ–‡å­˜å‚¨å¯†ç 

**SSH Key**
- ä½¿ç”¨ç³»ç»Ÿç°æœ‰çš„ SSH é…ç½®
- ä¸å­˜å‚¨ SSH ç§é’¥

### 7.3 è¾“å…¥éªŒè¯

**Git URL**
- æ­£åˆ™è¡¨è¾¾å¼éªŒè¯
- é˜²æ­¢ SQL æ³¨å…¥ï¼ˆè™½ç„¶ä¸ç”¨æ•°æ®åº“ï¼Œä½†è¦é˜²æ­¢å‘½ä»¤æ³¨å…¥ï¼‰

**JSON è§£æ**
- ä½¿ç”¨ serde_json çš„å®‰å…¨è§£æ
- é™åˆ¶ JSON æ–‡ä»¶å¤§å°ï¼ˆé˜²æ­¢ DoSï¼‰

---

## æµ‹è¯•ç­–ç•¥

### 8.1 å•å…ƒæµ‹è¯•

**åç«¯æµ‹è¯•**
- Git æ“ä½œåŠŸèƒ½æµ‹è¯•ï¼ˆä½¿ç”¨ mock Gitï¼‰
- é…ç½®è¯»å†™æµ‹è¯•
- æ•°æ®èšåˆé€»è¾‘æµ‹è¯•
- å†²çªå¤„ç†æµ‹è¯•

**å‰ç«¯æµ‹è¯•**
- ç»„ä»¶æ¸²æŸ“æµ‹è¯•
- ç”¨æˆ·äº¤äº’æµ‹è¯•ï¼ˆä½¿ç”¨ React Testing Libraryï¼‰

### 8.2 é›†æˆæµ‹è¯•

**Git ä»“åº“ç®¡ç†æµç¨‹**
1. æ·»åŠ ä¸€ä¸ªæµ‹è¯•ä»“åº“
2. éªŒè¯å…‹éš†æˆåŠŸ
3. éªŒè¯æ•°æ®èšåˆæ­£ç¡®
4. æ›´æ–°ä»“åº“
5. åˆ é™¤ä»“åº“

**å¤šä»“åº“åœºæ™¯**
1. æ·»åŠ å¤šä¸ªä»“åº“
2. æµ‹è¯•ä¼˜å…ˆçº§æ’åº
3. æµ‹è¯•æ’ä»¶å†²çªå¤„ç†
4. æµ‹è¯•å¯ç”¨/ç¦ç”¨åŠŸèƒ½

### 8.3 æ‰‹åŠ¨æµ‹è¯•æ¸…å•

```
Git ä»“åº“ç®¡ç†:
[ ] æ·»åŠ å…¬å¼€ä»“åº“ï¼ˆHTTPSï¼‰
[ ] æ·»åŠ éœ€è¦ SSH è®¤è¯çš„ä»“åº“
[ ] æ·»åŠ æ— æ•ˆ URLï¼ˆåº”æ˜¾ç¤ºé”™è¯¯ï¼‰
[ ] æ·»åŠ æ²¡æœ‰ marketplace.json çš„ä»“åº“ï¼ˆåº”éªŒè¯å¤±è´¥ï¼‰
[ ] æ›´æ–°ä»“åº“ï¼ˆgit pullï¼‰
[ ] åˆ é™¤ä»“åº“
[ ] å¯ç”¨/ç¦ç”¨ä»“åº“

è®¾ç½®åŠŸèƒ½:
[ ] æ‰“å¼€è®¾ç½®å¯¹è¯æ¡†
[ ] åˆ‡æ¢å„ä¸ªé€‰é¡¹å¡
[ ] ä¿®æ”¹ä¸»é¢˜è®¾ç½®å¹¶åº”ç”¨
[ ] ä¿®æ”¹è¯­è¨€è®¾ç½®å¹¶åº”ç”¨
[ ] ä¿å­˜è®¾ç½®åé‡å¯åº”ç”¨ï¼ŒéªŒè¯è®¾ç½®æŒä¹…åŒ–
[ ] é‡ç½®æ‰€æœ‰è®¾ç½®
[ ] æ¸…é™¤ç¼“å­˜

æ•°æ®èšåˆ:
[ ] å¤šä¸ªä»“åº“åŒ…å«ç›¸åŒæ’ä»¶ï¼ŒéªŒè¯ä¼˜å…ˆçº§ç”Ÿæ•ˆ
[ ] ä¿®æ”¹ä»“åº“ä¼˜å…ˆçº§ï¼ŒéªŒè¯æ’ä»¶åˆ—è¡¨æ›´æ–°
[ ] ç¦ç”¨ä»“åº“åï¼ŒéªŒè¯è¯¥ä»“åº“çš„æ’ä»¶ä¸å†æ˜¾ç¤º

è·¨å¹³å°:
[ ] Windows æµ‹è¯•
[ ] macOS æµ‹è¯•
[ ] Linux æµ‹è¯•
```

---

## å®æ–½è®¡åˆ’

### Phase 4: Git Marketplace ä¸è®¾ç½®åŠŸèƒ½ï¼ˆ5-7 å¤©ï¼‰

#### Stage 1: åŸºç¡€æ¶æ„ï¼ˆ2 å¤©ï¼‰

**Day 1: æ•°æ®æ¨¡å‹å’Œé…ç½®ç®¡ç†**
- [ ] å®šä¹‰ Rust ç±»å‹ï¼ˆAppConfig, RepositoryInfo ç­‰ï¼‰
- [ ] å®ç° `config_manager.rs`
  - [ ] é…ç½®æ–‡ä»¶è¯»å†™
  - [ ] é»˜è®¤é…ç½®åˆå§‹åŒ–
  - [ ] é…ç½®éªŒè¯
- [ ] åˆ›å»ºåˆå§‹é…ç½®æ–‡ä»¶ç»“æ„
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•

**Day 2: Git æ“ä½œå°è£…**
- [ ] å®ç° `git_manager.rs`
  - [ ] clone_repository
  - [ ] pull_repository
  - [ ] validate_marketplace_repo
- [ ] å¤„ç† Git é”™è¯¯å’Œå¼‚å¸¸
- [ ] è·¨å¹³å°è·¯å¾„å¤„ç†
- [ ] ç¼–å†™é›†æˆæµ‹è¯•

#### Stage 2: åç«¯ Marketplace èšåˆï¼ˆ1.5 å¤©ï¼‰

**Day 3: Marketplace Manager**
- [ ] å®ç° `marketplace_manager.rs`
  - [ ] å¤šä»“åº“æ•°æ®è¯»å–
  - [ ] æ’ä»¶æ•°æ®åˆå¹¶é€»è¾‘
  - [ ] å†²çªå¤„ç†ï¼ˆä¼˜å…ˆçº§ï¼‰
  - [ ] ç¼“å­˜æœºåˆ¶
- [ ] ä¿®æ”¹ç°æœ‰ `marketplace.rs` è°ƒç”¨æ–°çš„èšåˆé€»è¾‘
- [ ] Tauri Command æ³¨å†Œ
- [ ] æµ‹è¯•æ•°æ®èšåˆæ­£ç¡®æ€§

#### Stage 3: å‰ç«¯è®¾ç½®ç•Œé¢ï¼ˆ2 å¤©ï¼‰

**Day 4: è®¾ç½®å¯¹è¯æ¡†æ¡†æ¶**
- [ ] åˆ›å»º `SettingsDialog.tsx`
  - [ ] é€‰é¡¹å¡å¯¼èˆª
  - [ ] å¸ƒå±€å’Œæ ·å¼
- [ ] åˆ›å»º `GeneralSettings.tsx`
  - [ ] ä¸»é¢˜é€‰æ‹©
  - [ ] è¯­è¨€é€‰æ‹©
  - [ ] å…¶ä»–é€šç”¨è®¾ç½®
- [ ] å®ç°è®¾ç½®ä¿å­˜å’Œåº”ç”¨

**Day 5: Marketplace ä»“åº“ç®¡ç†ç•Œé¢**
- [ ] åˆ›å»º `MarketplaceSettings.tsx`
  - [ ] ä»“åº“åˆ—è¡¨å±•ç¤º
  - [ ] æ·»åŠ ä»“åº“å¯¹è¯æ¡†ï¼ˆ`AddRepositoryDialog.tsx`ï¼‰
  - [ ] ä»“åº“æ“ä½œï¼ˆæ›´æ–°ã€åˆ é™¤ã€å¯ç”¨/ç¦ç”¨ï¼‰
  - [ ] ä¼˜å…ˆçº§è°ƒæ•´
- [ ] å®ç°åŠ è½½çŠ¶æ€å’Œé”™è¯¯å¤„ç†
- [ ] è¿æ¥åç«¯ API

#### Stage 4: å…¶ä»–è®¾ç½®é¡µé¢å’Œä¼˜åŒ–ï¼ˆ1.5 å¤©ï¼‰

**Day 6: é«˜çº§è®¾ç½®å’Œå…³äºé¡µé¢**
- [ ] åˆ›å»º `AdvancedSettings.tsx`
  - [ ] æ¸…é™¤ç¼“å­˜åŠŸèƒ½
  - [ ] æ¸…é™¤å†å²è®°å½•
  - [ ] å¼€å‘è€…é€‰é¡¹
- [ ] åˆ›å»º `AboutPage.tsx`
  - [ ] ç‰ˆæœ¬ä¿¡æ¯
  - [ ] å¼€æºè®¸å¯
- [ ] åœ¨ Topbar ä¸­è¿æ¥è®¾ç½®æŒ‰é’®

**Day 7: æµ‹è¯•å’Œä¼˜åŒ–**
- [ ] å®Œæ•´åŠŸèƒ½æµ‹è¯•
- [ ] å¤šä»“åº“åœºæ™¯æµ‹è¯•
- [ ] UI/UX ä¼˜åŒ–
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆç¼“å­˜ç­–ç•¥ï¼‰
- [ ] æ–‡æ¡£æ›´æ–°

---

## é™„å½•

### A. æ–‡ä»¶æ¸…å•

**æ–°å»ºæ–‡ä»¶**

åç«¯ï¼ˆRustï¼‰:
- `src-tauri/src/commands/git_manager.rs`
- `src-tauri/src/commands/marketplace_manager.rs`
- `src-tauri/src/commands/config_manager.rs`

å‰ç«¯ï¼ˆTypeScript/Reactï¼‰:
- `src/components/SettingsDialog.tsx`
- `src/components/settings/GeneralSettings.tsx`
- `src/components/settings/MarketplaceSettings.tsx`
- `src/components/settings/AgentSettings.tsx`
- `src/components/settings/AdvancedSettings.tsx`
- `src/components/settings/AboutPage.tsx`
- `src/components/settings/AddRepositoryDialog.tsx`
- `src/lib/types.ts`

**ä¿®æ”¹æ–‡ä»¶**

- `src-tauri/src/lib.rs` - æ³¨å†Œæ–° commands
- `src-tauri/src/commands/mod.rs` - æ·»åŠ æ¨¡å—å£°æ˜
- `src-tauri/src/types.rs` - æ·»åŠ æ–°ç±»å‹å®šä¹‰
- `src/lib/api.ts` - æ·»åŠ æ–° API å‡½æ•°
- `src/components/Topbar.tsx` - è¿æ¥è®¾ç½®æŒ‰é’®
- `src/App.tsx` - æ·»åŠ è®¾ç½®å¯¹è¯æ¡†çŠ¶æ€ç®¡ç†

### B. ä¾èµ–é¡¹

**Rust Crates (å¯é€‰)**
```toml
[dependencies]
# (å¯é€‰) å¦‚æœä½¿ç”¨ git2-rs è€Œä¸æ˜¯ç³»ç»Ÿ git
git2 = "0.18"

# (å¯é€‰) ç”¨äºå®‰å…¨å­˜å‚¨è®¤è¯ä¿¡æ¯
keyring = "2.0"
```

**NPM Packages (å¯èƒ½éœ€è¦)**
```json
{
  "dependencies": {
    // å¯èƒ½å·²å®‰è£…ï¼Œç”¨äºè¡¨æ ¼ç»„ä»¶
    "@radix-ui/react-table": "^0.1.0"
  }
}
```

### C. é…ç½®æ¨¡æ¿

**é»˜è®¤ config.json**

```json
{
  "version": "1.0",
  "general": {
    "theme": "auto",
    "language": "zh-CN",
    "startup_page": "install",
    "card_density": "comfortable",
    "auto_check_updates": true,
    "confirm_before_install": false
  },
  "marketplace": {
    "repositories": [
      {
        "id": "official",
        "name": "Official Skillbox",
        "url": "https://github.com/Jst-Well-Dan/Skill-Box",
        "type": "official",
        "enabled": true,
        "priority": 1,
        "local_path": "~/.skillbox-studio/repositories/official-skillbox",
        "last_updated": "",
        "auth_type": "public"
      }
    ]
  },
  "agents": {
    "custom_paths": {},
    "custom_icons": {}
  },
  "advanced": {
    "debug_mode": false,
    "cache_enabled": true,
    "max_history_records": 500
  }
}
```

---

## æ€»ç»“

æœ¬è®¾è®¡æ–‡æ¡£æä¾›äº†**Git Marketplace ä»“åº“å¯¼å…¥ç³»ç»Ÿ**å’Œ**è®¾ç½®åŠŸèƒ½æ¨¡å—**çš„å®Œæ•´è®¾è®¡æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ï¼š

âœ… **æ¸…æ™°çš„åŠŸèƒ½éœ€æ±‚å®šä¹‰**  
âœ… **è¯¦ç»†çš„æŠ€æœ¯æ¶æ„**  
âœ… **å®Œæ•´çš„ API è®¾è®¡**  
âœ… **å…·ä½“çš„ UI/UX æ–¹æ¡ˆ**  
âœ… **å®‰å…¨æ€§è€ƒè™‘**  
âœ… **æµ‹è¯•ç­–ç•¥**  
âœ… **åˆ†é˜¶æ®µå®æ–½è®¡åˆ’**

æ–‡æ¡£å·²ä¿å­˜åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼š`FEATURE_DESIGN.md`

ä¸‹ä¸€æ­¥å¯ä»¥æ ¹æ®æ­¤è®¾è®¡æ–‡æ¡£åˆ›å»ºè¯¦ç»†çš„å®æ–½è®¡åˆ’ï¼ˆImplementation Planï¼‰ï¼Œå¹¶è¿›å…¥å¼€å‘é˜¶æ®µã€‚
